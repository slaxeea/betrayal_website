<!DOCTYPE html>

<html>

<head>
    <title>Betrayal by Michele</title>
    <link rel="stylesheet" href="style/style.css" />
    <link rel="stylesheet" href="style/new_navbtn.css" />
    <link rel="import" href="style/footer.html">
    <link rel="stylesheet" href="form.css" />
    <link rel="shortcut icon" type="image/png" href="imgs/favicon.png" />
    <meta charset="utf-8" />
    <meta name="description" content="Betrayal by Michel Biondi" />
    <meta name="keywords" content="Betrayal" />
    <meta name="author" content="Michele Biondi & Simon Kappeler" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta lang="en" />

</head>

<body>
    <div class="head">

        <body>
            <div class="grid-container">
                <div class="head" id="head">
                    <ul class="nav-bar">
                        <li><a href="about.html" class="btn-flip" id="a">about</a></li>
                        <li><a href="collections.html" class="btn-flip">collections</a></li>
                        <li><a href="index.html" class="btn-flip">home</a></li>
                    </ul>
                </div>
            </div>



            <div class="main">
                <form class="form" action="not_found.html">
                    <label for="vorname">Name: </label><br>
                    <input type="text" id="vorname" required> <br>

                    <label for="name">Lastname: </label><br>
                    <input type="text" id="name" required>


                    <label for="adresse">Adress: </label>
                    <input type="text" id="adresse" required> <br>

                    <label for="plz">Town and Zipcode </label>
                    <input type="text" id="plz" required> <br>

                    <label for="nummer">Smartphone Nr.: </label>
                    <input type="text" id="nummer" required><br><br>

                    <label for="anz">Amount: </label>
                    <input type="number" id="anz" min="1" max="10" required>

                    <label for="anz">Product: </label>
                    <select type="text" id="produkt" required>
                        <option value="T-Shirt White">T-Shirt White</option>
                        <option value="T-Shirt Black">T-Shirt Black</option>
                    </select>

                    <label for="size">Size: </label>
                    <select type="text" id="size" required>
                        <option value="s">S</option>
                        <option value="m">M</option>
                        <option value="l">L</option>
                        <option value="xl">XL</option>
                    </select>
                </form><br>
                <br><br>

                <div class="qr-sec">
                    <h3 class="qr-desc">You can pay here with twint and we will send you your order as soon as we get
                        the payment<br><br>T-Shirts cost 30.- each. Shipment included</h3><br><br>
                    <img src="imgs/qr-code.png" alt="qr-code" class="qr">
                    <h3 class="qr-desc">If you can't, just fill out the form and we will contact you on WhatsApp</h3>
                </div>
            </div>

            <br>
            <p class="error" id="error">

            </p>
            <br><br><button class="submit-btn" onclick="sendMsg()">submit</button><br> <br>
            <br><br><br>

            <div class="foot">
                <!--footer stuff-->
                <div class="item5">
                    <hr />
                    <a href="https://www.instagram.com/btrylclothing/" class="link" target="_blank">
                        <h5 class="inline">
                            instagram
                        </h5>
                    </a>
                    <p class="inline">
                        &nbsp; | &nbsp;
                    </p>
                    </a>
                    <a class="link" href="mailto:btrylclothing@hotmail.com">
                        <h5 class="inline">
                            mail
                        </h5>
                    </a>
                    <a class="link">
                        <br />
                        <h5 class="inline">
                            copyright Betrayal TM &nbsp;| &nbsp; <a href="https://instagram.com/ned_de_simon"
                                class="link"> Made
                                by
                                Simon</a>
                        </h5>
                    </a>
                </div>
            </div>
            <a href="animation.html" target="_self" style="display: none;" id="hidden-btn"></a>
        </body>
        <script>
            function sendMsg() {

                var vornameVal = document.getElementById("vorname").value;
                var nameVal = document.getElementById("name").value;
                var realnr = document.getElementById("nummer").value;
                nummerVal = realnr.replace(/\s/g, '');
                var adresseVal = document.getElementById("adresse").value;
                var produktVal = document.getElementById("produkt").value;
                var plzVal = document.getElementById("plz").value;
                var anzVal = document.getElementById("anz").value;
                var sizeVal = document.getElementById("size").value;

                let current = new Date();
                let cDate = current.getDate() + '.' + (current.getMonth() + 1) + '.' + current.getFullYear();
                let cTime = current.getHours() + ":" + current.getMinutes() + ":" + current.getSeconds();
                let dateTime = cDate + '  ' + cTime;

                // Regexes
                let reg = new RegExp("^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$");
                let adresReg = new RegExp("[A-Za-z0-9'\.\-\s\,]");


                // Check if a field is empty
                if (!vornameVal || !nameVal || !nummerVal || !adresseVal || !produktVal || !plzVal || !anzVal || !sizeVal) {
                    document.getElementById('error').textContent = "You forgot something!";
                }
                else if (!reg.test(nummerVal)) {
                    document.getElementById('error').textContent = "Enter a correct phone number pls. Example: 011 111 11 11";
                }
                else if (anzVal > 10 || anzVal <= 0) {
                    document.getElementById('error').textContent = "The maximum is 10 Products, dont take it from the others :)";
                }
                else if (!adresReg.test(plzVal)) {
                    document.getElementById('error').textContent = "Please enter a Town with the Form '1111 Townname'";
                }
                else {
                    // var win = window.open(`https://wa.me/${410795657025}?text=aaaaaa`, '_blank');
                    var request = new XMLHttpRequest();
                    request.open("POST", "https://discordapp.com/api/webhooks/844281270670590002/-AJaYkyZ5I5MwjboCPMxSNFr_KmUqLutIILWhy1nw5qDpAlZ3ii_ZWIis4AkmtziXIRU");
                    request.setRequestHeader('Content-type', 'application/json');

                    var params = {
                        username: "Simon sin Bstelligs Bot",
                        avatar_url: "https://btrylclothing.neocities.org/imgs/logo_white.png",
                        content: null,
                        embeds: [{
                            title: "Neue Bestellung!",
                            description: `${anzVal} mal ${produktVal} \nGrÃ¶sse ${sizeVal}\n\nVon ${vornameVal}  ${nameVal} \n${adresseVal} \n${plzVal}\n\nNummer: ${realnr}\n\nWurde bestellt am ${cDate} um ${cTime} \n\n`,
                            color: 4456637
                        }]
                    };
                    request.send(JSON.stringify(params));

                    setTimeout(() => { document.getElementById("hidden-btn").click(); }, 1000);
                }
            }
        </script>

</html>